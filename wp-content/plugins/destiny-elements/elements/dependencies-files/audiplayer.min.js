const deAudioPlayers=document.querySelectorAll(".de-audio-player");let playlistItem;function formatTime(time){if(isNaN(time)||time<0)return"0:00";const formatter=new Intl.DateTimeFormat("en-US",{minute:"numeric",second:"numeric"});return formatter.format(1e3*time)}deAudioPlayers.forEach(audioPlayer=>{const audioElement=audioPlayer.querySelector("audio");if(audioElement.classList.contains("de-default-player"))return void audioElement.addEventListener("play",()=>{stopAllSongs(audioElement)});const autoplay=audioPlayer.getAttribute("data-autoplay"),playPuaseBtn=audioPlayer.querySelector(".play-icon"),playIcon=audioPlayer.querySelector(".play-icon-svg"),pauseIcon=audioPlayer.querySelector(".pause-icon-svg"),currentTimeElement=audioPlayer.querySelector(".current-time"),durationElement=audioPlayer.querySelector(".duration"),seekSlider=audioPlayer.querySelector(".seek-slider"),volumeOutput=audioPlayer.querySelector(".volume-output"),muteIcon=audioPlayer.querySelector(".mute-icon"),muteIconSvg=audioPlayer.querySelector(".mute-icon-svg"),mutedIconSvg=audioPlayer.querySelector(".muted-icon-svg"),volumeSlider=audioPlayer.querySelector(".volume-slider"),timeWrapper=audioPlayer.querySelector(".progress-before"),loadingIndicator=audioPlayer.querySelector(".loading-indicator"),nextButton=audioPlayer.querySelector(".next-song"),previousButton=audioPlayer.querySelector(".prev-song");playlistItem=audioPlayer.querySelectorAll(".playlist-item");const mainSongName=audioPlayer.querySelector(".main-song-name");let currentAudio=audioElement,currenAudioIndex=0;function stopAllSongs(currentAudio,playIcon,pauseIcon){deAudioPlayers.forEach(audioPlayer=>{const audioElement=audioPlayer.querySelector("audio");if(audioElement===currentAudio)return;if(audioElement.classList.contains("de-default-player"))return void audioElement.pause();const playIcon=audioPlayer.querySelector(".play-icon-svg"),pauseIcon=audioPlayer.querySelector(".pause-icon-svg");audioElement.pause(),playIcon.classList.remove("hide"),pauseIcon.classList.add("hide");const playlistItem=audioPlayer.querySelectorAll(".playlist-item");playlistItem.forEach(el=>{const audioFile=el.querySelector("audio");audioFile.pause()})})}function playSong(index){if(playlistItem.forEach(item=>{item.classList.remove("active")}),0==index?previousButton.classList.add("disabled"):previousButton.classList.remove("disabled"),index==playlistItem.length-1?nextButton.classList.add("disabled"):nextButton.classList.remove("disabled"),index<0||index>=playlistItem.length)return;playlistItem[index].classList.add("active");const audioFile=playlistItem[index].querySelector("audio"),songName=playlistItem[index].querySelector(".song-name"),durationEl=playlistItem[index].querySelector(".duration");stopAllSongs(playIcon,pauseIcon),mainSongName.innerHTML=songName.innerHTML,audioElement.src=audioFile.src,currentAudio=audioElement,currentAudio.play(),updateDuration(durationEl,audioFile.duration)}function playNextSong(){currenAudioIndex<playlistItem.length-1?(currenAudioIndex++,playSong(currenAudioIndex)):"true"==autoplay&&(currentAudio.pause(),playIcon.classList.remove("hide"),pauseIcon.classList.add("hide"))}function playPreviousSong(){currenAudioIndex>0&&(currenAudioIndex--,playSong(currenAudioIndex))}function updateDuration(durationEl,duration){durationEl.textContent=formatTime(duration)}currentAudio.addEventListener("waiting",(function(){loadingIndicator.classList.remove("hide"),playIcon.classList.add("hide"),pauseIcon.classList.remove("hide")})),currentAudio.addEventListener("playing",(function(){loadingIndicator.classList.add("hide"),playIcon.classList.add("hide"),pauseIcon.classList.remove("hide")})),playlistItem.forEach((el,index)=>{const songName=el.querySelector(".song-name"),audioFile=el.querySelector("audio"),durationEl=el.querySelector(".duration");el.setAttribute("data-no",index),audioFile.addEventListener("loadedmetadata",(function(){durationEl.textContent=formatTime(audioFile.duration)})),el.addEventListener("click",(function(){stopAllSongs(currentAudio,playIcon,pauseIcon),mainSongName.innerHTML=songName.innerHTML,playlistItem.forEach(item=>{item.classList.remove("active")}),el.classList.add("active"),timeWrapper.style.setProperty("--seek-before-width","10%"),audioElement.src=audioFile.src,currentAudio=audioElement,currentAudio.play(),currenAudioIndex=Number(el.getAttribute("data-no")),0==currenAudioIndex?previousButton.classList.add("disabled"):previousButton.classList.remove("disabled"),currenAudioIndex==playlistItem.length-1?nextButton.classList.add("disabled"):nextButton.classList.remove("disabled"),playIcon.classList.add("hide"),pauseIcon.classList.remove("hide"),currentAudio.addEventListener("loadedmetadata",()=>{currentTimeElement.textContent=formatTime(currentAudio.currentTime),durationElement.textContent=formatTime(currentAudio.duration);let percentageValue=100*currentAudio.currentTime/currentAudio.duration;seekSlider.value=percentageValue})}))}),playPuaseBtn.addEventListener("click",(function(){currentAudio.paused?(stopAllSongs(currentAudio,playIcon,pauseIcon),currentAudio.play(),playIcon.classList.add("hide"),pauseIcon.classList.remove("hide")):(currentAudio.pause(),playIcon.classList.remove("hide"),pauseIcon.classList.add("hide")),currentAudio.paused&&loadingIndicator.classList.add("hide")})),currentAudio.addEventListener("timeupdate",(function(){const currentTime=currentAudio.currentTime,duration=currentAudio.duration;currentTimeElement.textContent=formatTime(currentTime);let percentageValue=100*currentTime/duration;seekSlider.value=percentageValue,timeWrapper.style.setProperty("--seek-before-width",percentageValue.toFixed()+"%"),currentTime==duration&&(playIcon.classList.remove("hide"),pauseIcon.classList.add("hide"))})),currentAudio.addEventListener("loadedmetadata",(function(){const duration=currentAudio.duration;durationElement.textContent=formatTime(duration)})),currentAudio.addEventListener("timeupdate",(function(){if(currentAudio.src===audioElement.src){const currentTime=currentAudio.currentTime,duration=currentAudio.duration;currentTimeElement.textContent=formatTime(currentTime);let percentageValue=100*currentTime/duration;seekSlider.value=percentageValue,timeWrapper.style.setProperty("--seek-before-width",percentageValue.toFixed()+"%"),currentTime===duration&&(playIcon.classList.remove("hide"),pauseIcon.classList.add("hide"))}})),seekSlider.addEventListener("input",(function(){const duration=currentAudio.duration,value=seekSlider.value,currentTime=value*duration/100;currentAudio.currentTime=currentTime,currentTimeElement.textContent=formatTime(currentTime);let percentageValue=100*currentTime/duration;timeWrapper.style.setProperty("--seek-before-width",percentageValue.toFixed()+"%")})),muteIcon.addEventListener("click",(function(){currentAudio.muted=!currentAudio.muted,muteIconSvg.classList.toggle("hide"),mutedIconSvg.classList.toggle("hide")})),volumeSlider.addEventListener("input",(function(){currentAudio.volume=volumeSlider.value/100,volumeOutput.value=volumeSlider.value})),currentAudio.addEventListener("ended",(function(){"true"==autoplay&&playNextSong()})),nextButton&&(nextButton.addEventListener("click",playNextSong),previousButton.addEventListener("click",playPreviousSong))});