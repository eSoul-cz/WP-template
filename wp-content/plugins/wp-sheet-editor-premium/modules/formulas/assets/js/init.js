function vgseAddField(e,t){return e.append('<div class="vg-field"><'+t.tag+"></"+t.tag+"></div>"),$field=e.find(".vg-field").last(),"select"===t.tag&&t.options&&$field.find(t.tag).append(t.options),void 0!==t.html_attrs[""]&&delete t.html_attrs[""],$field.find(t.tag).attr(t.html_attrs),t.tooltip&&t.label&&(t.label+=' <a href="#" data-wpse-tooltip="right" aria-label="'+t.tooltip+'">( ? )</a>'),t.label&&"a"!==t.tag&&$field.prepend("<label>"+t.label+"</label>"),t.label&&"a"===t.tag&&$field.find(t.tag).text(t.label),t.description&&$field.append("<p>"+t.description+"</p>"),"a"===t.tag&&$field.append('<input type="hidden" name="formula_data[]" />'),$field}function vgseGenerateMathFormula(e){return!!e.firstFieldValue&&'=MATH("'+e.firstFieldValue+'")'}function vgseGenerateDecreasePercentageFormula(e){return!!e.firstFieldValue&&'=MATH("$current_value$ - (($current_value$ * '+parseFloat(e.firstFieldValue)+') / 100)")'}function vgseGenerateIncreasePercentageFormula(e){return!!e.firstFieldValue&&'=MATH("$current_value$ + (($current_value$ * '+parseFloat(e.firstFieldValue)+') / 100)")'}function vgseGenerateDecreaseFormula(e){return!!e.firstFieldValue&&'=MATH("$current_value$ - '+e.firstFieldValue+'")'}function vgseGenerateIncreaseFormula(e){return!!e.firstFieldValue&&'=MATH("$current_value$ + '+e.firstFieldValue+'")'}function vgseGenerateFakeFormula(e){return'=REPLACE(""$current_value$"",""$current_value$"")'}function vgseGenerateSetValueFormula(e){if(e.actionSettings.fields_relationship||(e.actionSettings.fields_relationship="AND"),"or"===e.actionSettings.fields_relationship.toLowerCase()&&1<e.actionFields.length){var t="";e.actionFields.each(function(){jQuery(this).val()&&(t=jQuery(this).val())}),e.firstFieldValue=t}return jQuery(".formula-builder .action-fields .wpse-hidden-value").length&&(e.firstFieldValue=jQuery(".formula-builder .action-fields .wpse-hidden-value").val()),!!e.firstFieldValue&&'=REPLACE(""$current_value$"",""'+e.firstFieldValue+'"")'}function vgseGenerateSetRandomValueFormula(e){if(e.actionSettings.fields_relationship||(e.actionSettings.fields_relationship="AND"),"or"===e.actionSettings.fields_relationship.toLowerCase()&&1<e.actionFields.length){var t="";e.actionFields.each(function(){jQuery(this).val()&&(t=jQuery(this).val())}),e.firstFieldValue=t}return!!e.firstFieldValue&&'=REPLACE(""$current_value$"",""$random_value_start$'+e.firstFieldValue+'$random_value_end$"")'}function vgseGenerateAppendFormula(e){if(e.actionSettings.fields_relationship||(e.actionSettings.fields_relationship="AND"),"or"===e.actionSettings.fields_relationship.toLowerCase()&&1<e.actionFields.length){var t="";e.actionFields.each(function(){jQuery(this).val()&&(t=jQuery(this).val())}),e.firstFieldValue=t}if(!e.firstFieldValue)return!1;var a=jQuery(".column-selector select"),i="";return"post_terms"!==a.find("option:selected").data("value-type")&&"boton_gallery_multiple"!==a.find("option:selected").data("value-type")||(i=vgse_editor_settings.taxonomy_terms_separator),e.columnSettings.list_separation_character&&"string"==typeof e.columnSettings.list_separation_character&&(i=e.columnSettings.list_separation_character),'=REPLACE(""$current_value$"",""$current_value$'+i+e.firstFieldValue+'"")'}function vgseGenerateClearValueFormula(e){return'=REPLACE(""$current_value$"","""")'}function vgseGenerateCapitalizeWordsFormula(e){return'=REPLACE(""$current_value$"",""$current_value_capitalize_each_word$"")'}function vgseGenerateExcerptFormula(e){return!!e.firstFieldValue&&'=REPLACE(""$current_value$"",""$current_value_excerpt'+e.firstFieldValue+'$"")'}function vgseGenerateCustomFormula(e){return!!e.firstFieldValue&&(e.firstFieldValue.indexOf("=REPLACE")<0&&e.firstFieldValue.indexOf("=MATH")<0?(alert(vgse_formulas_data.texts.wrong_formula),""):e.firstFieldValue)}function vgseGeneratePHPFormula(e){return!!e.firstFieldValue&&(e.firstFieldValue.match(/^[a-z0-9\_\:]+$/i)?"=PHP:"+e.firstFieldValue+"()":(alert(vgse_formulas_data.texts.wrong_formula),""))}function vgseGeneratePrependFormula(e){if(e.actionSettings.fields_relationship||(e.actionSettings.fields_relationship="AND"),"or"===e.actionSettings.fields_relationship.toLowerCase()&&1<e.actionFields.length){var t="";e.actionFields.each(function(){jQuery(this).val()&&(t=jQuery(this).val())}),e.firstFieldValue=t}if(!e.firstFieldValue)return!1;var a=jQuery(".column-selector select"),i="";return"post_terms"!==a.find("option:selected").data("value-type")&&"boton_gallery_multiple"!==a.find("option:selected").data("value-type")||(i=vgse_editor_settings.taxonomy_terms_separator),e.columnSettings.list_separation_character&&"string"==typeof e.columnSettings.list_separation_character&&(i=e.columnSettings.list_separation_character),'=REPLACE(""$current_value$"",""'+e.firstFieldValue+i+'$current_value$"")'}function vgseGenerateReplaceFormula(e){var t=[];return e.actionFields.each(function(){var e=jQuery(this).val()||"";t.push('""'+e+'""')}),!(t.length<2)&&"=REPLACE("+t.join(",")+")"}function vgseGenerateMergeFormula(e){var t="";return e.actionFields.each(function(){var e=jQuery(this).val();e&&!t&&(t=e)}),!!t&&'=REPLACE(""$current_value$"",""'+t+'"")'}jQuery(document).ready(function(){var w=jQuery(".modal-formula form"),y=jQuery(".vgse-execute-formula"),b=w.find(".formula-textarea");w.find(".wpse-formula-post-query").on("click",function(e){e.preventDefault(),window.vgseBackToFormula=!0,jQuery('[name="run_filters"]').first().click()}),w.find(".wpse-select-rows-options").on("change",function(e){"new_search"===jQuery(this).val()?(window.vgseBackToFormula=!0,jQuery('[name="run_filters"]').first().click(),w.find(".wpse-formula-post-query").show()):w.find(".wpse-formula-post-query").hide(),jQuery(".modal-formula .rows-to-be-updated-total span").text(vgseGetSelectedRowsCount(w))}),w.find(".wpse-select-rows-options").trigger("change"),jQuery(document).on("closed",'[data-remodal-id="modal-filters"]',function(){void 0!==window.vgseBackToFormula&&window.vgseBackToFormula&&(window.vgseBackToFormula=!1,jQuery('[data-remodal-target="modal-formula"]').first().click())}),jQuery(document).on("closing",'[data-remodal-id="modal-formula"]',function(){var e=jQuery(".modal-formula"),t=e.find(".go-back-formula-execution");t.is(":visible")&&t.first().click(),e.find(".formula-builder, .use-slower-execution-field, .multiple-column-selector").show(),e.find("form").removeAttr("novalidate"),e.find("form").show(),e.find(".preview-wrapper").addClass("hidden"),e.find(".preview-wrapper .preview-result").empty()}),vgseGetPostTypeColumnsOptions({supports_formulas:!0},!1,!1,!1).forEach(function(e){w.find(".multiple-column-selector select").append(e)}),vgseGetPostTypeColumnsOptions({supports_formulas:!0},!0,!1,!1).forEach(function(e){vgse_formulas_data.default_actions.merge_columns.input_fields[0].options+=e}),w.find(".multiple-column-selector > select").on("change",function(e){var t=jQuery(this).val(),a=w.find(".column-selector select"),i=!1;t&&"object"==typeof t&&t.forEach(function(e){if(e&&!i)return i=e,!0}),i?a.val(i):a.val(""),a.trigger("change")}),jQuery(".modal-formula form").on("submit",function(){if(w.find('[name="schedule_for_later"]').prop("checked"))return!0;if(!w.find(".wpse-select-rows-options").val())return!1;var e=vgseGetSelectedRowsCount(w);if("selected"===w.find(".wpse-select-rows-options").val())var o=vgseGetSelectedIds();if("previously_selected"===w.find(".wpse-select-rows-options").val())o=window.wpsePreviouslySelectedIds||[];if(void 0!==o&&(e=o.length)){var l=beGetRowsFilters();beAddRowsFilter("post__in="+o.join(","))}if(!vgseGetSelectedRowsCount(w))return alert(vgse_editor_settings.texts.no_rows_for_formula),!1;if(beGetModifiedItems().length&&!confirm(vgse_editor_settings.texts.save_changes_before_we_reload))return!1;if("function"==typeof beGetRowsFilters&&w.find('input[name="filters_found_rows"]').val(e),!b.val())return alert(vgse_formulas_data.texts.formula_required),!1;w.hide(),y.show();var t=w.find('[name="nonce"]').val(),r=w.find('[name="filters_found_rows"]').val(),a=b.val(),i=w.find('[name="post_type"]').val(),s=jQuery(".be-response");y.find(".speed-tip").hide(),y.find(".edit-running").show(),y.find(".pause-formula-execution").show(),y.find("#be-formulas-nanobar-container").remove(),s.before('<div id="be-formulas-nanobar-container"></div>');var n={classname:"be-progress-bar",target:document.getElementById("be-formulas-nanobar-container")},d=0,u=w.find(".multiple-column-selector > select option:selected"),c=[];u.each(function(){jQuery(this).val()&&c.push({label:jQuery(this).text(),key:jQuery(this).val()})});c[0].key;1<c.length?s.addClass("multiple-edits"):s.addClass("single-edit");var f=new Nanobar(n);f.go(1),y.find(".remodal-cancel").hide();var p={total:0,processed:0,updated:0},m=vgse_editor_settings.save_posts_per_page,_=w.find(".action_name").val(),v=w.find(".action-fields").find("select,input,textarea").first().val();vgse_editor_settings.sheet_uses_real_time_sync||!vgse_editor_settings.is_post_type||"set_value"!==_||"delete"!==v||vgse_editor_settings.delete_attached_images_when_post_delete||(m=vgse_editor_settings.delete_posts_per_page),"send_email"!==w.find(".action_name").val()||w.find("#formula-send-email-editor").val()||w.find("#formula-send-email-editor").val(wp.editor.getContent("formula-send-email-editor"));var g=vgseGuidGenerator(),h=Math.ceil(r/m);return window.beFormulaLoop=beAjaxLoop({totalCalls:Math.ceil(r/m),url:vgse_global_data.ajax_url,dataType:"json",method:"POST",data:{action:"vgse_bulk_edit_formula_big",total:r,column:c[d].key,apply_to:"all",formula:a,nonce:t,post_type:i,filters:vgseGetFiltersJson(),raw_form_data:w.serialize(),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||"",wpse_job_id:g},onSuccess:function(e,t){if(!e.success)return s.append("<p>"+e.data.message+"</p>"),s.scrollTop(s[0].scrollHeight),f.go(100),y.find("#be-formulas-nanobar-container").remove(),y.find(".remodal-cancel").show(),!1;p.processed+=e.data.processed,p.updated+=e.data.updated,p.total||(p.total+=e.data.total),t.totalCalls=h;var a=e.data.force_complete?100:parseInt(t.current/t.totalCalls*100);if(a<1&&(a=1),e.data.message=e.data.message.replace("{total}",p.total),e.data.message=e.data.message.replace("{progress_percentage}",a),e.data.message=e.data.message.replace("{edited}",p.updated),e.data.message=e.data.message.replace("{column_label}",c[d].label),s.find(".success-message").each(function(){jQuery(this).data("column-key")===t.data.column&&jQuery(this).remove()}),s.find(".complete-message").remove(),s.append(e.data.message),s.scrollTop(s[0].scrollHeight),e.data.force_complete){if(1<c.length&&d<c.length-1)return d++,t.data.column=c[d].key,t.current=0,t.totalCalls=Math.ceil(r/m),f.go(1),p.processed=p.updated=p.total=0,!0;var i=vgse_editor_settings.texts.formula_execution_complete;return vgse_editor_settings.texts.ask_review&&(i+="<br>"+vgse_editor_settings.texts.ask_review),s.append(i),y.find(".edit-running").hide(),y.find(".pause-formula-execution").hide(),f.go(100),y.find("#be-formulas-nanobar-container").remove(),y.find(".remodal-cancel").show(),void 0!==l&&(beAddRowsFilter("post__in="),"selected"===w.find(".wpse-select-rows-options").val()&&o.length&&(window.wpsePreviouslySelectedIds=o)),w.find('.wpse-select-rows-options option[value="previously_selected"]').hide(),window.wpsePreviouslySelectedIds&&w.find('.wpse-select-rows-options option[value="previously_selected"]').show(),vgseReloadSpreadsheet(),!1}if(t.current!==t.totalCalls)return y.find(".speed-tip").show(),f.go(a),y.find(".remodal-cancel").hide(),!0;if(1<c.length&&d<c.length-1)return d++,t.data.column=c[d].key,t.current=0,t.totalCalls=Math.ceil(r/m),f.go(1),p.processed=p.updated=p.total=0,!0;y.find(".edit-running").hide(),y.find(".pause-formula-execution").hide();i=vgse_editor_settings.texts.formula_execution_complete;return vgse_editor_settings.texts.ask_review&&(i+="<br>"+vgse_editor_settings.texts.ask_review),s.append(i),s.scrollTop(s[0].scrollHeight),f.go(100),y.find("#be-formulas-nanobar-container").remove(),y.find(".remodal-cancel").show(),void 0!==l&&(beAddRowsFilter("post__in="),"selected"===w.find(".wpse-select-rows-options").val()&&o.length&&(window.wpsePreviouslySelectedIds=o)),w.find('.wpse-select-rows-options option[value="previously_selected"]').hide(),window.wpsePreviouslySelectedIds&&w.find('.wpse-select-rows-options option[value="previously_selected"]').show(),vgseReloadSpreadsheet(),!1},onError:function(e,t,a){return confirm(vgse_editor_settings.texts.formula_retry_batch)?(window.vgseDontNotifyServerError=!0,a.current--,f.go(a.current/a.totalCalls*100),y.find(".remodal-cancel").hide(),!0):(s.append(vgse_editor_settings.texts.formula_execution_failed),s.scrollTop(s[0].scrollHeight),f.go(100),y.find("#be-formulas-nanobar-container").remove(),y.find(".remodal-cancel").show(),!1)}}),jQuery(".pause-formula-execution").data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),y.find(".be-response").empty(),!1}),jQuery(".pause-formula-execution").on("click",function(e){e.preventDefault();var t=jQuery(this);"pause"===t.data("action")?(t.data("action","play").addClass("button-primary").removeClass("button-secondary").html('<i class="fa fa-play"></i> Resume'),window.beFormulaLoop.pause()):(t.data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),window.beFormulaLoop.resume())}),jQuery(".go-back-formula-execution").on("click",function(e){e.preventDefault(),w.show(),y.hide(),jQuery(".pause-formula-execution").data("action","play").addClass("button-primary").removeClass("button-secondary").html('<i class="fa fa-play"></i> Resume'),window.beFormulaLoop.pause()});var m=jQuery(".formula-builder"),u=jQuery(".column-selector select"),l=vgseAddField(m,{tag:"select",label:vgse_formulas_data.texts.action_select_label,html_attrs:{name:"action_name",class:"action_name",id:"action_name"},options:'<option value="" class="placeholder">'+vgse_formulas_data.texts.action_select_placeholder+"</option>"});m.append('<div class="builder-fields"></div>'),m.append('<div class="preview-wrapper hidden"><button type="button" class="generate-preview button">'+vgseEscapeHTML(vgse_editor_settings.texts.formula_preview_button)+'</button><div class="preview-result"></div></div>');var c=m.find(".builder-fields");jQuery.each(vgse_formulas_data.columns_actions,function(e,t){if("default"===t)t=vgse_formulas_data.default_actions;else{var a={};jQuery.each(t,function(e,t){t="default"===t?vgse_formulas_data.default_actions[e]:jQuery.extend({},vgse_formulas_data.default_actions[e],t),a[e]=t}),t=a}vgse_formulas_data.columns_actions[e]=t}),u.on("change",function(e){var t=jQuery(this),i=t.val(),a=t.find("option:selected").data("value-type"),o=vgse_editor_settings.final_spreadsheet_columns_settings[i];columnFields=vgse_formulas_data.columns_actions[a],columnFields||(u.find("option:selected").data("value-type","text"),columnFields=vgse_formulas_data.columns_actions.text),l.find("select option:not(.placeholder)").remove(),c.empty(),jQuery.each(columnFields,function(e,t){if(o&&o.supported_formula_types&&o.supported_formula_types.length&&o.supported_formula_types.indexOf(e)<0)return!0;var a=void 0===t.allowed_column_keys||!t.allowed_column_keys||-1<t.allowed_column_keys.indexOf(i);void 0!==t.disallowed_column_keys&&-1<t.disallowed_column_keys.indexOf(i)&&(a=!1),a&&l.find("select").append('<option value="'+e+'">'+t.label+"</option>")})}),m.find(".preview-wrapper .generate-preview").click(function(e){e.preventDefault();var o=jQuery(this);o.hide();var l=m.find(".preview-result");l.empty();var t=jQuery(".modal-formula form");loading_ajax(!0);var a=t.find('[name="nonce"]').val(),i=vgseGetSelectedRowsCount(t),r=b.val(),s=t.find('[name="post_type"]').val(),n=vgseGuidGenerator(),d=vgseGetFiltersJson();if("selected"===t.find(".wpse-select-rows-options").val())var u=vgseGetSelectedIds();if("previously_selected"===t.find(".wpse-select-rows-options").val())u=window.wpsePreviouslySelectedIds||[];void 0!==u&&(d="post__in="+u.join(","));var c=t.find(".multiple-column-selector > select option:selected"),f=[];c.each(function(){jQuery(this).val()&&f.push({label:jQuery(this).text(),key:jQuery(this).val()})});var p=vgse_editor_settings.final_spreadsheet_columns_settings[f[0].key];try{jQuery.ajax({url:vgse_global_data.ajax_url,dataType:"json",method:"POST",data:{action:"vgse_bulk_edit_formula_big",total:i,column:f[0].key,formula:r,nonce:a,page:1,post_type:s,wpse_job_id:n,is_preview:!0,filters:d,raw_form_data:t.serialize(),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||""},success:function(e){if(loading_ajax(!1),e.success){var t,a="",i=e.data;if(a+="<p><strong>"+vgseEscapeHTML(vgse_editor_settings.texts.formula_preview_sample_row_id)+":</strong> "+parseInt(i.post_id)+"</p>",i.initial_data)(t=vgseEscapeHTML(i.initial_data).substring(0,200)).length<i.initial_data.length&&(t+="..."),a+="<p><strong>"+vgseEscapeHTML(vgse_editor_settings.texts.formula_preview_old_value)+":</strong></p>",a+="<div>"+t+"</div>";if(a+="<p><strong>"+vgseEscapeHTML(vgse_editor_settings.texts.formula_preview_new_value)+":</strong></p>","string"!=typeof i.data&&(i.data=String(i.data)),0===i.data.indexOf(window.location.origin)&&0===p.type.indexOf("boton_gallery"))a+='<div><img src="'+i.data+'" alt="image preview" /></div>';else(t=vgseEscapeHTML(i.data).substring(0,200)).length<i.data.length&&(t+="..."),a+="<div>"+t+"</div>";l.append(a)}o.show()},error:function(e,t,a){loading_ajax(!1),o.show()}})}catch(e){loading_ajax(!1),o.show(),l.append("<p>"+vgse_editor_settings.texts.formula_preview_failed+"</p>")}}),l.find("select").on("change",function(e){var t=jQuery(this),a=t.val();if(!a)return!0;var i=u.find("option:selected").data("value-type"),l=vgse_formulas_data.columns_actions[i][a],o=l.input_fields;m.find(".preview-wrapper").addClass("hidden"),m.find(".preview-wrapper .preview-result").empty(),c.empty(),c.attr("data-column-key",u.val()),l.description&&(l.description=l.description.replace("%target_column%",u.val()),c.append('<p class="action-description">'+l.description+"</p>")),c.append('<div class="action-fields"></div>');var r=c.find(".action-fields"),s={tag:"",label:"",description:"",html_attrs:{class:"formula-parameter-field",type:"text"}};jQuery.each(o,function(e,t){t=jQuery.extend({},s,t),l.fields_relationship||(l.fields_relationship="AND"),void 0!==t.html_attrs&&void 0!==t.html_attrs.name&&t.html_attrs.name||!t.tag||!/input|textarea|select/i.test(t.tag)||(t.html_attrs.name="formula_data[]");var a=JSON.stringify(t.html_attrs);a=a.replace(/\{column_key\}/g,u.val()),t.html_attrs=JSON.parse(a),r.append('<span class="relationship-'+l.fields_relationship.toLowerCase()+' relationship">'+l.fields_relationship+"</span>"),vgseAddField(r,t)}),r.find(".select2")&&"function"==typeof vgseInitSelect2&&vgseInitSelect2();var n="formula-send-email-editor";"send_email"===t.val()?(wp.editor.initialize(n,{tinymce:{wpautop:!0,plugins:"charmap colorpicker compat3x directionality fullscreen hr image lists media paste tabfocus textcolor wordpress wpautoresize wpdialogs wpeditimage wpemoji wpgallery wplink wptextpattern wpview",toolbar1:"bold italic underline strikethrough | bullist numlist | blockquote hr wp_more | alignleft aligncenter alignright | link unlink | fullscreen | wp_adv",toolbar2:"formatselect alignjustify forecolor | pastetext removeformat charmap | outdent indent | undo redo | wp_help"},quicktags:{buttons:"strong,em,link,ul,li,code"},mediaButtons:!0}),window.vgseFormulaSendEmailEditorLoaded=!0):window.vgseFormulaSendEmailEditorLoaded&&(wp.editor.remove(n),window.vgseFormulaSendEmailEditorLoaded=!1),r.find("input,textarea").each(function(){vgseInputToFormattedColumnField(u.val(),jQuery(this).parent(),".formula-parameter-field")});var d=r.find("input,select,textarea");d.on("change",function(e){var t=u.val(),a=vgse_editor_settings.final_spreadsheet_columns_settings[t],i=d.filter(function(){return jQuery(this).attr("name")}),o=vgseExecuteFunctionByName(l.jsCallback,window,{changedField:jQuery(this),actionFields:i,actionSettings:l,firstField:i.first(),firstFieldValue:i.first().val(),columnSettings:a});o=o||"",b.val(o),!function(e){var t=!0;return e.disallow_preview&&(t=!1),b.val()||(t=!1),vgseGetSelectedRowsCount(w)||(t=!1),t&&jQuery('select[name="columns[]"]').val().forEach(function(e){-1<vgse_formulas_data.columns_disallowed_preview.indexOf(e)&&(t=!1)}),t}(l)?(m.find(".preview-wrapper").addClass("hidden"),m.find(".preview-wrapper .preview-result").empty()):m.find(".preview-wrapper").removeClass("hidden")}),d.first().trigger("change"),jQuery(".modal-formula .rows-to-be-updated-total span").text(vgseGetSelectedRowsCount(w))}),jQuery("body").on("click",".wp-media.button",function(e){loading_ajax({estado:!0});var t=jQuery(this),o=t.parent().find("input"),a=t.data("multiple"),l=jQuery("body").scrollLeft(),r=[],i=jQuery(document).scrollTop(),s=jQuery("#infinito").prop("checked");jQuery("#infinito").prop("checked",!1),media_uploader=wp.media({frame:"post",state:"insert",multiple:a}),media_uploader.state("embed").on("select",function(){var e=media_uploader.state(),t=e.get("type"),a=e.props.toJSON();a.url=a.url||"","image"===t&&a.url&&(o.val(a.url).trigger("change"),o.after('<div class="selected-files"></div>'),o.next(".selected-files").append('<img src="'+a.url+'" width="80" height="80"/>'))}),media_uploader.on("close",function(){jQuery("body").scrollLeft(l),jQuery(window).scrollTop(i),jQuery("#infinito").prop("checked",s)}),media_uploader.on("insert",function(){jQuery("body").scrollLeft(l);var e=media_uploader.state().get("selection"),t=e.length,a=e.models;if(!a.length)return!0;o.parent().find(".selected-files").remove(),o.after('<div class="selected-files"></div>');for(var i=0;i<t;i++)file=a[i].toJSON(),r.push(a[i].id),o.next(".selected-files").append('<img src="'+file.sizes.thumbnail.url+'" width="80" height="80"/>');o.val(r).trigger("change")}),media_uploader.open(),loading_ajax({estado:!1})})}),jQuery(document).ready(function(){jQuery("body").on("mousedown","th .bulk-selector",function(e){jQuery("th .bulk-selector").data("value-before-click",jQuery(this).prop("checked"))}),jQuery("body").on("click","th .bulk-selector",function(e){for(var t=jQuery(this),a=jQuery("th .bulk-selector"),i=!t.data("value-before-click"),o=hot.countRows()-1,l=[],r=0;r<=o;r++)l.push([r,0,i]);if(hot.setDataAtCell(l),jQuery("th .bulk-selector").prop("checked",i),a.data("value-before-click",i),i){if(!window.wpseDontOpenBulkEditOnSelectAll)jQuery('[data-remodal-id="modal-formula"]').remodal().open();var s=vgse_editor_settings.enable_pagination?"selected":"current_search";jQuery(".modal-formula .wpse-select-rows-options").val(s).trigger("change")}}),jQuery(document).on("opened",".modal-formula",function(){vgseGetSelectedIds().length&&!jQuery("th .bulk-selector").prop("checked")&&jQuery(".modal-formula .wpse-select-rows-options").val("selected").trigger("change"),jQuery(".modal-formula .rows-to-be-updated-total span").text(vgseGetSelectedRowsCount(jQuery(".modal-formula")))})}),jQuery(document).ready(function(){jQuery(".quick-bulk-action").on("click",function(){var t=jQuery(this).data("action"),e=jQuery(".modal-formula");t.allow_to_select_column||e.find(".multiple-column-selector").hide(),t.columns&&(e.find(".multiple-column-selector select").val(""),e.find(".multiple-column-selector select option").filter(function(){return-1<t.columns.indexOf(jQuery(this).val())}).prop("selected",!0),e.find(".multiple-column-selector select").trigger("change")),t.type_of_edit&&e.find("select.action_name").val(t.type_of_edit).trigger("change"),t.values&&e.find(".action-fields").each(function(e){t.values[e]&&jQuery(this).find("input,textarea,select").first().val(t.values[e]).trigger("change")}),t.type_of_edit&&t.values&&(e.find(".formula-builder, .use-slower-execution-field").hide(),e.find("form").attr("novalidate","novalidate")),t.hide_slow_execution_field&&(e.find(".use-slower-execution-field").hide(),e.find("form").attr("novalidate","novalidate")),e.remodal().open()})}),jQuery(document).ready(function(){if("undefined"==typeof hot||!jQuery(".modal-formula").length)return!0;var e=hot.getSettings().contextMenu;void 0===e.items&&(e.items={}),e.items.wpse_bulk_edit_column={name:vgse_editor_settings.texts.bulk_edit_column,hidden:function(){if(!hot.getSelected())return!0;var e=hot.colToProp(hot.getSelected()[0][1]),t=vgse_editor_settings.final_spreadsheet_columns_settings[e];return t&&!t.supports_formulas},callback:function(e,t,a){var i=jQuery(".modal-formula");jQuery('[data-remodal-target="modal-formula"]').first().click();var o=hot.colToProp(t[0].start.col);i.find(".multiple-column-selector select").val(""),i.find(".multiple-column-selector select option").filter(function(){return jQuery(this).val()===o}).prop("selected",!0),i.find(".multiple-column-selector select").trigger("change")}},hot.updateSettings({contextMenu:e})});